<?xml version="1.0" encoding="utf-8"?><!--V.0.29--><ControlBlock BlockId="1312" BlockName="BEMF_MCHP" LibraryName="MCHP" Author="Mark Wendler" Revision="0.3" DateCreated="2016-12-07" DateLastChange="2020-05-11" Prompt="back electromotive force" Order="0" SampleTimeFactor="1" TexFile="BEMF_Info" LibraryType="INTERNAL" PreNameSpace="at.lcm.x2c" DefaultImplementation="FiP16" DirectFeedThrough="true" ParameterId="0" IsStaticId="false" IsConversionOnTarget="false" TaskLabel=""><BlockLicense Type="BSD 3-clause"><CopyrightStatement>Copyright (c) {YEAR}, {ORGANIZATION_NAME}, {ORGANIZATION_WEB}
All rights reserved.</CopyrightStatement><LicenseStatement>This file is licensed according to the BSD 3-clause license as follows:

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
  * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the
    documentation and/or other materials provided with the distribution.
  * Neither the name of the "{ORGANIZATION_NAME}" nor
    the names of its contributors may be used to endorse or promote products
    derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL "{ORGANIZATION_NAME}" BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</LicenseStatement><Header>This file is part of X2C. http://www.mechatronic-simulation.org/
$LastChangedRevision: 2894 $</Header></BlockLicense><Description>BEMFalpha=Va-Rs0*Ia-Ls0*deltaIa
BEMFbeta=Vb-Rs0*Ib-Ls0*deltaIb
FIP:
Rs0 = Rs*(I0/U0)
Ls0 = Ls*(I0/U0)
Float:
Rs0 = Rs
Ls0 = Ls</Description><Mask Name="Mask"><InportContainer><MaskInport Name="Ialpha"><Description>Clarke transformed A phase current</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Ibeta"><Description>Clarke transformed B phase current</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Valpha"><Description>Clarke transformed Output A phase voltage</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Vbeta"><Description>Clarke transformed Output B phase voltage</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport></InportContainer><OutportContainer><MaskOutport Name="BEMFalpha"><Description>back electromotive force alpha voltage</Description></MaskOutport><MaskOutport Name="BEMFbeta"><Description>back electromotive force beta voltage</Description></MaskOutport></OutportContainer><ParameterContainer><MaskParameter Name="Ls" Prompt="Ls: Motor inductance. (MilliHenry)"><Description>Motor phase inductance for Y connection (MilliHenry)</Description><MaskDouble><Value><Numeric>0.1</Numeric></Value><DefaultValue><Numeric>0.1</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="Rs" Prompt="Rs: Motor resistance (Ohm)"><Description>Motor phase resistance for Y connection (Ohm)</Description><MaskDouble><Value><Numeric>0.1</Numeric></Value><DefaultValue><Numeric>0.1</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="U0" Prompt="U0: DC link voltage (Only in Fip implementation)"><Description>U0: DC link voltage (Only in Fip implementation)</Description><MaskDouble><Value><Numeric>24.0</Numeric></Value><DefaultValue><Numeric>24.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="I0" Prompt="I0: maximum peak current (Only in Fip implementation)"><Description>The maximum peak current per phase (Only in Fip implementation)</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="ts_fact" Prompt="Sample Time Multiplier"><Description>Multiplication factor of base sampling time (in integer format).</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="CurrentSampleFactor" Prompt="Current Sample Factor (1 and bigger integers)"><Description>Division factor for current sample. (in integer format)
Current sample = ModelSampleTime/CurrentSampleFactor</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter></ParameterContainer><Visualizations><Visualization Name="ScilabXcos" Type="VisualizationScilabXcos"><ScriptDefineSection><Item>Ls_val = exprs(10);</Item><Item>Rs_val = exprs(14);</Item><Item>// R and L value</Item><Item>myStyle = "noLabel=0;displayedLabel=R=%14$sOhm&lt;br/&gt;L=%10$smH;"</Item><Item>myStyle = myStyle + "verticalAlign=bottom;" // place to the bottom</Item><Item>myStyle = myStyle + "fontSize=14;" // Text little bit bigger</Item><Item></Item><Item>x_sci.graphics.style = myStyle;</Item></ScriptDefineSection><ScriptPlotSection></ScriptPlotSection><ScriptStyle><Item>//style.rounded = 1; // Block edges rounded</Item><Item>//style.fillColor = "#FFB9B7"; // Upper color</Item><Item>//style.gradientColor = "#CE635E"; // Lower color</Item><Item>//Background image</Item><Item>style.image = "file:///" + strsubst(pwd(), "\", "/") + "/../Doc/Images/BEMF_calc.png";</Item></ScriptStyle><BlockIconDefaultSize>[8 5.5]</BlockIconDefaultSize></Visualization></Visualizations></Mask><ImplementationConfig><ExistingImplementationContainer><Implementation Id="0" Name="FiP16" FriendlyName="16 Bit Fixed Point" Author="Mark Wendler" Revision="0.2" DateCreated="2016-12-07" DateLastChange="2020-05-08" CFileName="BEMF_MCHP_FiP16.c" HFileName="BEMF_MCHP_FiP16.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>16 Bit Fixed Point Implementation</Description><InportContainer><ImplementationInport Name="Ialpha" DataType="INT16"></ImplementationInport><ImplementationInport Name="Ibeta" DataType="INT16"></ImplementationInport><ImplementationInport Name="Valpha" DataType="INT16"></ImplementationInport><ImplementationInport Name="Vbeta" DataType="INT16"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="BEMFalpha" DataType="INT16"></ImplementationOutport><ImplementationOutport Name="BEMFbeta" DataType="INT16"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="Ls" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase inductance. 
Scales by I0/U0</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Rs" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase resistance.
Scales by I0/U0.</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrLs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Ls</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrRs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Rs</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ib_old" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ia_old" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="CurrentSampleFactor" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Division factor for current sample.
Current sample: ModelSampleTime/CurrentSampleFactor</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_alpha" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_beta" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="FactCounter" DataType="UINT8" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Current Sample Factor loop counter.</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation><Implementation Id="1" Name="FiP32" FriendlyName="32 Bit Fixed Point" Author="Mark Wendler" Revision="0.2" DateCreated="2016-12-07" DateLastChange="2020-05-08" CFileName="BEMF_MCHP_FiP32.c" HFileName="BEMF_MCHP_FiP32.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>32 Bit Fixed Point Implementation</Description><InportContainer><ImplementationInport Name="Ialpha" DataType="INT32"></ImplementationInport><ImplementationInport Name="Ibeta" DataType="INT32"></ImplementationInport><ImplementationInport Name="Valpha" DataType="INT32"></ImplementationInport><ImplementationInport Name="Vbeta" DataType="INT32"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="BEMFalpha" DataType="INT32"></ImplementationOutport><ImplementationOutport Name="BEMFbeta" DataType="INT32"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="Ls" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase inductance.
Scales by I0/U0</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Rs" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase resistance
Scales by I0/U0</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrLs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Ls</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrRs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Rs</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ia_old" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ib_old" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="CurrentSampleFactor" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Division factor for current sample.
Current sample: ModelSampleTime/CurrentSampleFactor</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_alpha" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_beta" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="FactCounter" DataType="UINT8" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Current Sample Factor loop counter.</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation><Implementation Id="2" Name="Float32" FriendlyName="32 Bit Floating Point" Author="Mark Wendler" Revision="0.2" DateCreated="2017-01-24" DateLastChange="2020-05-08" CFileName="BEMF_MCHP_Float32.c" HFileName="BEMF_MCHP_Float32.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>32 Bit Floating Point Implementation</Description><InportContainer><ImplementationInport Name="Ialpha" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Ibeta" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Valpha" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Vbeta" DataType="FLOAT32"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="BEMFalpha" DataType="FLOAT32"></ImplementationOutport><ImplementationOutport Name="BEMFbeta" DataType="FLOAT32"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="Ls" DataType="FLOAT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase inductance.</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Rs" DataType="FLOAT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase resistance</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ia_old" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ib_old" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="CurrentSampleFactor" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Division factor for current sample.
Current sample: ModelSampleTime/CurrentSampleFactor</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_alpha" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_beta" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="FactCounter" DataType="UINT8" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Current Sample Factor loop counter.</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation></ExistingImplementationContainer><UsedImplementation></UsedImplementation></ImplementationConfig></ControlBlock>