<?xml version="1.0" encoding="utf-8"?><!--V.0.29--><ControlBlock BlockId="1313" BlockName="BEMF_PLL_MCHP" LibraryName="MCHP" Author="rkothbauer" Revision="0.1" DateCreated="2016-12-07" DateLastChange="2023-04-25" Prompt="calculates angle and speed from back electromotive force" Order="0" SampleTimeFactor="1" TexFile="" LibraryType="INTERNAL" PreNameSpace="at.lcm.x2c" DefaultImplementation="FiP16" DirectFeedThrough="true" ParameterId="0" IsStaticId="false" IsConversionOnTarget="false" TaskLabel=""><BlockLicense Type="None"><CopyrightStatement></CopyrightStatement><LicenseStatement></LicenseStatement><Header>This file is part of X2C. http://x2c.lcm.at/
$LastChangedRevision: 2894 $
$LastChangedDate:: 2023-08-08 19:24:56 +0200#$</Header></BlockLicense><Description>- calc stator fixed back electromotive force
BEMFalpha=Va-Rs0*Ia-Ls0*deltaIa
BEMFbeta=Vb-Rs0*Ib-Ls0*deltaIb
FIP:
Rs0 = Rs*(I0/U0)
Ls0 = Ls*(I0/U0)
Float:
Rs0 = Rs
Ls0 = Ls

- calcs park transform into rotor fixed reference frame (with delayed angle)
- calcs speed from bemf q-component
- calcs angle from speed</Description><Mask Name="Mask"><InportContainer><MaskInport Name="Ialpha"><Description>Clarke transformed A phase current</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Ibeta"><Description>Clarke transformed B phase current</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Valpha"><Description>Clarke transformed Output A phase voltage</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Vbeta"><Description>Clarke transformed Output B phase voltage</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="theta0"><Description>initial angle</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport><MaskInport Name="Enable"><Description>Enable == 0: Deactivation of block; Out is set to 0.
Enable 0-&gt;1: Preload of angle with value from Init input.
Enable == 1: Activation of block.</Description><ConnectedOutport Name=""><BlockLink Name=""></BlockLink></ConnectedOutport></MaskInport></InportContainer><OutportContainer><MaskOutport Name="theta"><Description>sensorless electric angle</Description></MaskOutport><MaskOutport Name="speed"><Description>sensorless speed</Description></MaskOutport></OutportContainer><ParameterContainer><MaskParameter Name="Ls" Prompt="Ls: Motor inductance. (MilliHenry)"><Description>Motor phase inductance for Y connection (MilliHenry)</Description><MaskDouble><Value><Numeric>0.1</Numeric></Value><DefaultValue><Numeric>0.1</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="Rs" Prompt="Rs: Motor resistance (Ohm)"><Description>Motor phase resistance for Y connection (Ohm)</Description><MaskDouble><Value><Numeric>0.1</Numeric></Value><DefaultValue><Numeric>0.1</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="U0" Prompt="U0: DC link voltage (Only in Fip implementation)"><Description>U0: DC link voltage (Only in Fip implementation)</Description><MaskDouble><Value><Numeric>24.0</Numeric></Value><DefaultValue><Numeric>24.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="I0" Prompt="I0: maximum peak current (Only in Fip implementation)"><Description>The maximum peak current per phase (Only in Fip implementation)</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="CurrentSampleFactor" Prompt="Current Sample Factor (1 and bigger integers)"><Description>Division factor for current sample. (in integer format)
Current sample = ModelSampleTime/CurrentSampleFactor</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="n" Prompt="n: Size of average window"><Description>Number of points to be averaged over.</Description><MaskComboBox><Value><String>1</String></Value><DefaultValue><String>1</String></DefaultValue><Content><Item><String>1</String></Item><Item><String>2</String></Item><Item><String>4</String></Item><Item><String>8</String></Item><Item><String>16</String></Item><Item><String>32</String></Item><Item><String>64</String></Item><Item><String>128</String></Item><Item><String>256</String></Item></Content></MaskComboBox></MaskParameter><MaskParameter Name="Gain" Prompt="Gain: BEMF/U_DC"><Description>Gain factor in floating point format.</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="p" Prompt="p: Number of pole pairs"><Description>Number of pole pairs</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="n_max" Prompt="n_max: Maximum (mechanical) speed [rpm]"><Description>Maximum revolutions per minute
(Not used by floating point implementations)</Description><MaskDouble><Value><Numeric>1000.0</Numeric></Value><DefaultValue><Numeric>1000.0</Numeric></DefaultValue></MaskDouble></MaskParameter><MaskParameter Name="ts_fact" Prompt="Sample Time Multiplier"><Description>Multiplication factor of base sampling time (in integer format).</Description><MaskDouble><Value><Numeric>1.0</Numeric></Value><DefaultValue><Numeric>1.0</Numeric></DefaultValue></MaskDouble></MaskParameter></ParameterContainer><Visualizations><Visualization Name="Matlab" Type="VisualizationMatlab"><Command><Item>patch([0 1 1], [0 0 1], [0.91 0.84 0])</Item><Item></Item><Item>disp('\fontsize{10}BEMF PLL','texmode', 'on')</Item><Item></Item><Item>port_label('input',1,'Ialpha');</Item><Item>port_label('input',2,'Ibeta');</Item><Item>port_label('input',3,'Valpha');</Item><Item>port_label('input',4,'Vbeta');</Item><Item>port_label('input',5,'theta_0');</Item><Item>port_label('input',6,'Enable');</Item><Item>port_label('input',7,'phiEl');</Item><Item></Item><Item>port_label('output',1,'theta');</Item><Item>port_label('output',2,'speed');</Item></Command></Visualization><Visualization Name="ScilabXcos" Type="VisualizationScilabXcos"><ScriptDefineSection><Item>//Ls_val = exprs(10);</Item><Item>//Rs_val = exprs(14);</Item><Item>// R and L value</Item><Item>myStyle = "noLabel=0;displayedLabel=R=%14$sOhm&lt;br/&gt;L=%10$smH;"</Item><Item>myStyle = myStyle + "verticalAlign=bottom;" // place to the bottom</Item><Item>myStyle = myStyle + "fontSize=14;" // Text little bit bigger</Item><Item></Item><Item>x_sci.graphics.style = myStyle;</Item></ScriptDefineSection><ScriptPlotSection></ScriptPlotSection><ScriptStyle><Item>//style.rounded = 1; // Block edges rounded</Item><Item>//style.fillColor = "#FFB9B7"; // Upper color</Item><Item>//style.gradientColor = "#CE635E"; // Lower color</Item><Item>//Background image</Item><Item>style.image = "file:///" + strsubst(pwd(), "\", "/") + "/../Doc/Images/BEMF_calc.png";</Item></ScriptStyle><BlockIconDefaultSize>[8 5.5]</BlockIconDefaultSize></Visualization></Visualizations></Mask><ImplementationConfig><ExistingImplementationContainer><Implementation Id="0" Name="FiP16" FriendlyName="16 Bit Fixed Point" Author="rkothbauer" Revision="0.1" DateCreated="2016-12-07" DateLastChange="2023-04-25" CFileName="BEMF_PLL_MCHP_FiP16.c" HFileName="BEMF_PLL_MCHP_FiP16.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>16 Bit Fixed Point Implementation</Description><InportContainer><ImplementationInport Name="Ialpha" DataType="INT16"></ImplementationInport><ImplementationInport Name="Ibeta" DataType="INT16"></ImplementationInport><ImplementationInport Name="Valpha" DataType="INT16"></ImplementationInport><ImplementationInport Name="Vbeta" DataType="INT16"></ImplementationInport><ImplementationInport Name="theta0" DataType="INT16"></ImplementationInport><ImplementationInport Name="Enable" DataType="BOOL"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="theta" DataType="INT16"></ImplementationOutport><ImplementationOutport Name="speed" DataType="INT16"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="Ls" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase inductance. 
Scales by I0/U0</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Rs" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase resistance.
Scales by I0/U0.</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrLs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Ls</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrRs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Rs</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ib_old" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ia_old" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="CurrentSampleFactor" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Division factor for current sample.
Current sample: ModelSampleTime/CurrentSampleFactor</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_alpha" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_beta" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="FactCounter" DataType="UINT8" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Current Sample Factor loop counter.</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="old_theta" DataType="INT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>angle value of previous update cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="avg_d" DataType="INT16" isLoadable="false" isSaveable="false" isArray="true" isFlashArray="false" arraySize="256"><Description></Description><Value><Numeric>[0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]</Numeric></Value></ImplementationParameter><ImplementationParameter Name="avg_q" DataType="INT16" isLoadable="false" isSaveable="false" isArray="true" isFlashArray="false" arraySize="256"><Description>Array with data values</Description><Value><Numeric>[0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sum_d" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Temporary sum</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sum_q" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Temporary sum</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="n" DataType="UINT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Average window size</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrn" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for computation of average value sfrn = ld(n)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="count" DataType="UINT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Index counter</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_gain" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Gain factor.</Description><Value><Numeric>32767.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfr_gain" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor of gain</Description><Value><Numeric>15.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b0" DataType="INT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Integral coefficient</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfr_b0" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for I coefficient b0</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="i_old" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Integrator value from previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="enable_old" DataType="BOOL" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Integrator value from previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation><Implementation Id="1" Name="FiP32" FriendlyName="32 Bit Fixed Point" Author="Mark Wendler" Revision="0.2" DateCreated="2016-12-07" DateLastChange="2023-04-25" CFileName="BEMF_PLL_MCHP_FiP32.c" HFileName="BEMF_PLL_MCHP_FiP32.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>32 Bit Fixed Point Implementation</Description><InportContainer><ImplementationInport Name="Ialpha" DataType="INT32"></ImplementationInport><ImplementationInport Name="Ibeta" DataType="INT32"></ImplementationInport><ImplementationInport Name="Valpha" DataType="INT32"></ImplementationInport><ImplementationInport Name="Vbeta" DataType="INT32"></ImplementationInport><ImplementationInport Name="theta0" DataType="INT32"></ImplementationInport><ImplementationInport Name="Enable" DataType="BOOL"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="theta" DataType="INT32"></ImplementationOutport><ImplementationOutport Name="speed" DataType="INT32"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="Ls" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase inductance.
Scales by I0/U0</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Rs" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase resistance
Scales by I0/U0</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrLs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Ls</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrRs" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for Rs</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ia_old" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ib_old" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="CurrentSampleFactor" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Division factor for current sample.
Current sample: ModelSampleTime/CurrentSampleFactor</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_alpha" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_beta" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="FactCounter" DataType="UINT8" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Current Sample Factor loop counter.</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="old_theta" DataType="INT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>angle value of previous update cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="n" DataType="UINT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Average window size</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfrn" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for computation of average value sfrn = ld(n)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sum_d" DataType="INT64" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Temporary sum</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sum_q" DataType="INT64" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Temporary sum</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="count" DataType="UINT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Index counter</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="avg_d" DataType="INT32" isLoadable="false" isSaveable="false" isArray="true" isFlashArray="false" arraySize="256"><Description>Array with data values</Description><Value><Numeric>[0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]</Numeric></Value></ImplementationParameter><ImplementationParameter Name="avg_q" DataType="INT32" isLoadable="false" isSaveable="false" isArray="true" isFlashArray="false" arraySize="256"><Description>Array with data values</Description><Value><Numeric>[0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_gain" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Gain factor.</Description><Value><Numeric>2.147483647e9</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfr_gain" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>shift factor of gain</Description><Value><Numeric>15.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b0" DataType="INT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Integral coefficient</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sfr_b0" DataType="INT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Shift factor for I coefficient b0</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="i_old" DataType="INT64" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Integrator value from previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="enable_old" DataType="BOOL" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Enable value of previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation><Implementation Id="2" Name="Float32" FriendlyName="32 Bit Floating Point" Author="Mark Wendler" Revision="0.2" DateCreated="2017-01-24" DateLastChange="2023-04-25" CFileName="BEMF_PLL_MCHP_Float32.c" HFileName="BEMF_PLL_MCHP_Float32.h" UpdateEnabled="true" ChecksumCFile="" ChecksumHFile="" AllowEmptyLoadFnc="false"><Description>32 Bit Floating Point Implementation</Description><InportContainer><ImplementationInport Name="Ialpha" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Ibeta" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Valpha" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Vbeta" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="theta0" DataType="FLOAT32"></ImplementationInport><ImplementationInport Name="Enable" DataType="BOOL"></ImplementationInport></InportContainer><OutportContainer><ImplementationOutport Name="theta" DataType="FLOAT32"></ImplementationOutport><ImplementationOutport Name="speed" DataType="FLOAT32"></ImplementationOutport></OutportContainer><ParameterContainer><ImplementationParameter Name="Ls" DataType="FLOAT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase inductance.</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Rs" DataType="FLOAT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Motor phase resistance</Description><Value><Numeric>0.1</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ia_old" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="Ib_old" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Input value from previous cycle. 
Sample time divided by CurrentSampleFactor</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="CurrentSampleFactor" DataType="UINT8" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Division factor for current sample.
Current sample: ModelSampleTime/CurrentSampleFactor</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_alpha" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_Ls_beta" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Voltage of inductance.
(Save data for next calculation)</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="FactCounter" DataType="UINT8" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Current Sample Factor loop counter.</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="old_theta" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>angle value of previous update cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="n" DataType="UINT16" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Average window size</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sum_d" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Temporary sum</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="sum_q" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Temporary sum</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="count" DataType="UINT16" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Index counter</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="avg_d" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="true" isFlashArray="false" arraySize="256"><Description>Array with data values</Description><Value><Numeric>[0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]</Numeric></Value></ImplementationParameter><ImplementationParameter Name="avg_q" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="true" isFlashArray="false" arraySize="256"><Description>Array with data values</Description><Value><Numeric>[0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0]</Numeric></Value></ImplementationParameter><ImplementationParameter Name="V_gain" DataType="FLOAT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Gain factor.</Description><Value><Numeric>1.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="b0" DataType="FLOAT32" isLoadable="true" isSaveable="true" isArray="false" isFlashArray="false" arraySize="0"><Description>Integral coefficient</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="i_old" DataType="FLOAT32" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Integrator value from previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter><ImplementationParameter Name="enable_old" DataType="BOOL" isLoadable="false" isSaveable="false" isArray="false" isFlashArray="false" arraySize="0"><Description>Enable value of previous cycle</Description><Value><Numeric>0.0</Numeric></Value></ImplementationParameter></ParameterContainer><Conversion Type="JavaScript" Language="JavaScript"></Conversion><FunctionLink Status="false" BlockName="" ImplementationName=""></FunctionLink></Implementation></ExistingImplementationContainer><UsedImplementation></UsedImplementation></ImplementationConfig></ControlBlock>